var $jscomp={scope:{},findInternal:function(c,a,d){c instanceof String&&(c=String(c));for(var b=c.length,e=0;e<b;e++){var g=c[e];if(a.call(d,g,e,c))return{i:e,v:g}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[a]=d.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,a,d,b){if(a){d=$jscomp.global;c=c.split(".");for(b=0;b<c.length-1;b++){var e=c[b];e in d||(d[e]={});d=d[e]}c=c[c.length-1];b=d[c];a=a(b);a!=b&&null!=a&&$jscomp.defineProperty(d,c,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
define(function(){return{process:function(c,a){var d=function(b){require(["message_handler"],function(c){c.process(a,b)})};(function(){c.refreshToken&&(a.connection.close(),a.initSession(function(){a.Connect()},{regenerate:1}))})();(function(b){if(b.guests&&0==a.guestEditState){a.guests=b.guests;b=a.guests;a.domElems.guestList.empty();a.domElems.guestMiniList.empty();a.domElems.address.empty();var c="<tr><th>\u0418\u043c\u044f</th><th>\u0422\u0418\u041c</th><th>\u0413\u043e\u0440\u043e\u0434</th><th>\u0412\u043e\u0437\u0440\u0430\u0441\u0442</th><th></th></tr>",
g="",d='<option value="">\u0412\u0441\u0435\u043c</option>',l;for(l in b){var f=b[l],d=d+('<option value="'+f.user_id+'">'+f.name+"</option>"),h=null;"\u041c\u0443\u0436\u0447\u0438\u043d\u0430"==f.sex?h="info":"\u0416\u0435\u043d\u0449\u0438\u043d\u0430"==f.sex?h="danger":"\u0410\u043d\u043e\u043d\u0438\u043c"==f.sex?h="active":f.banned&&(h="warning");var k="";0<f.karma?k="success":0>f.karma&&(k="danger");g+='<div class="'+h+'">';g+=a.getAvatar(f)+' <span class="user-name">'+f.name+"</span>";g+=
'<sup class="'+k+'">'+(0<f.karma?"+":"")+f.karma+"</sup></div>";c+='<tr class="'+h+'">';c+="<td>"+a.getAvatar(f)+' <span class="user-name">'+f.name;c+='<sup class="'+k+'">'+(0<f.karma?"+":"")+f.karma+"</sup></span></td>";c+="<td>"+f.tim+"</td>";c+="<td>"+(f.city?f.city:"")+"</td>";c+="<td>"+(f.birth?f.birth:"")+"</td>";c+='<td><div class="pull-right btn-group btn-group-sm ilb" data-id="'+f.user_id+'">';f.banned?c+='<a class="btn btn-default unban" title="\u0420\u0430\u0437\u0431\u0430\u043d"><span class="glyphicon glyphicon-eye-open"></span></a>':
f.user_id!=a.user.id&&(c+='<a class="btn btn-default private" title="\u041f\u0440\u0438\u0433\u043b\u0430\u0441\u0438\u0442\u044c \u0432 \u043f\u0440\u0438\u0432\u0430\u0442"><span class="glyphicon glyphicon-glass"></span></a>',c+='<a class="btn btn-default ban" title="\u0418\u0433\u043d\u043e\u0440"><span class="glyphicon glyphicon-eye-close"></span></a>');c+="</div></td></tr>";f.note&&(c+='<tr id="user-note-'+f.user_id+'" class="'+h+'">',c+='<td colspan="5" class="no-border-top"><div class="col-md-12">',
c+=f.note,c+="</div></td></tr>")}a.domElems.guestList.append(c);a.domElems.guestMiniList.append(g);a.domElems.address.append(d);a.domElems.guestList.find(".user-avatar").click(function(){var b=this;require(["userdetails_handler"],function(c){c.process(a,$(b).data("id"))})});a.domElems.guestMiniList.find(".user-avatar").click(function(){var b=this;require(["userdetails_handler"],function(c){c.process(a,$(b).data("id"))})});a.domElems.guestMiniList.find(".user-name").click(function(){a.domElems.inputMessage.val($(this).text()+
", "+a.domElems.inputMessage.val())});a.domElems.guestList.find(".ban").click(function(){var b={subject:"Blacklist",action:"ban",user_id:$(this).parent().data("id")};a.send(b);a.returnToChat()});a.domElems.guestList.find(".unban").click(function(){var b={subject:"Blacklist",action:"unban",user_id:$(this).parent().data("id")};a.send(b);a.returnToChat()});a.domElems.guestList.find(".private").click(function(){var b=$(this).parent().data("id");a.togglePrivate(b)});a.domElems.address.find("option[value="+
a.domElems.address.data("id")+"]").attr("selected","selected");a.guestCount=b.length;a.domElems.guestCounter.text(a.guestCount)}})(c);(function(){if(c.ownProperties){var b=c.ownProperties;b.id&&(a.user.id=b.id,a.domElems.refLink.val(a.protocol+a.domain+"/ref.php?id="+b.id));b.name&&(a.domElems.nickname.val(b.name),a.user.name=b.name);b.about&&a.domElems.about.val(b.about);b.sex&&(a.domElems.sex.val(b.sex),a.user.sex=2==b.sex);b.tim&&(a.domElems.tim.val(b.tim),a.user.tim=b.tim);b.email&&(a.domElems.email.val(b.email),
a.user.email=b.email,a.domElems.loginLink.hide(),a.domElems.onlineNotification.show());if(b.avatarImg){var e=document.createElement("img");e.src=b.avatarImg;e.style.maxWidth="inherit";e.style.maxHeight="inherit";a.domElems.avatar.find("div.avatar-placeholder").html(e)}b.avatarThumb&&(e=document.createElement("img"),e.src=b.avatarThumb,a.domElems.avatar.find("div.avatar-placeholder-mini").html(e));b.birth&&a.domElems.birth.val(b.birth);b.city&&a.domElems.city.val(b.city);void 0!=b.censor&&a.domElems.censor.prop("checked",
b.censor);void 0!=b.isSubscribed&&a.domElems.subscription.prop("checked",b.isSubscribed);void 0!=b.notifyVisual&&(a.domElems.notifyVisual.prop("checked",b.notifyVisual),a.user.notifyVisual=b.notifyVisual);void 0!=b.notifySound&&(a.domElems.notifySound.prop("checked",b.notifySound),a.user.notifySound=b.notifySound);void 0!=b.lineBreakType&&(a.domElems.lineBreakType.filter("[value="+b.lineBreakType+"]").prop("checked",!0),a.user.lineBreakType=b.lineBreakType);void 0!=b.onlineNotifyLimit&&a.domElems.onlineNotification.val(b.onlineNotifyLimit);
void 0!=b.msgAnimationType&&(a.domElems.msgAnimationType.val(b.msgAnimationType),a.user.msgAnimationType=b.msgAnimationType)}})();(function(){if(c.history){c.clear&&(a.msgCount=0,a.domElems.chat.empty());var b={run:function(){a.domElems.chat.hide();for(var b in c.history)d(c.history[b])},end:function(){setTimeout(function(){a.domElems.chat.fadeIn(500,function(){a.scrollDown()})},150)}};b.run();b.end();a.lastMsgId=c.lastMsgId;a.scrollDown()}})();"match"==c.dualChat?(a.domElems.menuExit.parent().attr("style",
""),a.domElems.menuExit.show()):"exit"==c.dualChat&&a.domElems.menuExit.hide();d(c);c.disconnect&&(a.connection=null,a.disconnect=1);c.errors&&a.notifyError(c.errors);(function(){if(c.channels){var b=a.domElems.menuChannels;b.empty();for(var e in c.channels){var d='<li><a href="#" data-id="'+e+'">',d=d+(c.channels[e].name+" ["+c.channels[e].usersCount+"]");e==c.chatId&&(d+=' <span class="glyphicon glyphicon-ok-sign"></span>');d+="</a></li>";b.append(d)}a.currentChannel=c.chatId;e=c.channels[a.currentChannel].name;
17<e.length&&(e=e.substring(0,15)+"...");$("#channel-name").text(e);b.find("li a").click(function(){var b=$(this).data("id");b!=a.currentChannel&&a.send({subject:"Channel",action:"join",channelId:b})})}})();(function(){if(c.musicInfo){var b=c.musicInfo,e="music-"+b.track_id,d=$("#"+e);d.find(".audio-title").text(b.artist+" - "+b.track);d.data("src",b.url);d.click(function(b){require(["audio"],function(c){c.playMusic(a.domElems.audioPlayer,b,e)})})}})()}}});
